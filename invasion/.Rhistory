labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
ggsave('H3endemicVac.pandStrR0varyInvad.NoNatImm.png',pl.sigmaV.R0, width=9,height=9)
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic(panel.spacing = unit(2, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
ggsave('H3endemicVac.pandStrR0varyInvad.NoNatImm.png',pl.sigmaV.R0, width=9,height=9)
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme(panel.spacing = unit(2, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
ggsave('H3endemicVac.pandStrR0varyInvad.NoNatImm.png',pl.sigmaV.R0, width=9,height=9)
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme(panel.spacing = unit(1, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme(panel.spacing = unit(0.5, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme(panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_bw()+
theme(panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
# theme_bw()+
theme(panel.spacing = unit(0.8, "lines"))+
theme_classic()+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic(panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)),
panel.spacing = unit(0.8, "lines"))+
theme_classic()+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme( panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.margin.y = unit(0.8, "lines"),panel.margin.x = unit(0.4, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300))+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300),
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
ggsave('H3endemicVac.pandStrR0varyInvad.NoNatImm.png',pl.sigmaV.R0, width=9,height=7)
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3/52)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300)/52)+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300)/52,
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per week)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3/52/7)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300)/52/7)+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300)/52/7,
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per week)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
pl.sigmaV.R0
pl.sigmaV.R0 <- ggplot(simdf.t3.sigmaV,aes(x=H3vac.cov/52*100,y=pl.y,z=growth.rate.t3/52/7)) +
facet_grid(grp~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/grp),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.8, "lines"))+
geom_contour_filled(bins=6,breaks = c(-150,-75,0,75,150,225,300)/52/7)+
geom_contour(bins=6,breaks = c(-150,-75,0,75,150,225,300)/52/7,
aes(colour = factor(..level..==0,levels = c(T, F),
labels = c("Pandemic emergence","")))) +
scale_colour_manual(values = c("darkred", "#00000000")) +
labs(fill='Invading strain initial\ngrowth rate (per day)',color='')+
xlab('Vaccination rate (%) per week')+
labs(y=expression('susceptibility reduction by vaccines'~tau))+
# scale_x_continuous(expand = c(0,0),labels=c('0','0.5','1','1.5','2'))+
scale_y_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#287A22FF','#8DBC80FF',
'#fed976','#feb24c','#fc4e2a','#bd0026'))
ggsave('H3endemicVac.pandStrR0varyInvad.NoNatImm.png',pl.sigmaV.R0, width=9,height=7)
120*52
120*52/1024
52*1.5
rm(list=ls())
library(deSolve)
load('H3Vac.invad.RData')
parms0
1/parms0['mu']
load("/Users/qiqiy/Documents/P3_UIV/BroadFluVacModel/invasion/H3endemicVac.pandStrInvad5yrs.NoNatImm.RData")
library(plyr)
library(dplyr)
pandSize.R0 <- ldply(invad.list.R0, function(x){
invad.list <- lapply(x, function(df){
a <- ldply(df,rbind)
return(a)
})
trough <- ldply(invad.list,rbind) %>%
filter(time==1)
return(trough)
})
#
# traj <- traj.R0.2[[4]]
#
# pl.traj <- ggplot(data=traj,mapping = aes(x=time))+
#   geom_line(aes(y=inci1,lty=factor(immDur)))+
#   theme_classic() +
#   scale_y_log10()+
#   labs(lty='susceptibility reduction\nby vaccines',
#        y = 'Incidence of invading strain')
#
library(ggplot2)
pandSize.R0 <- pandSize.R0 %>%
mutate(immDur=1/H3vac.sigmaV,vac.rate=H3vac.cov/52*100,
pandSize=I1+I21+IV1)
hist(pandSize.R0$pandSize)
pl.pandSize.R0 <- ggplot(pandSize.R0,aes(x=vac.rate,y=H3vac.tau2,z=pandSize*1000)) +
facet_grid(immDur~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/immDur),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.6, "lines"))+
geom_contour_filled(bins=5)+
labs(fill='Pandemic attack \nrate (x10e-3)',color='')+
xlab('Vaccination rate (%) per week')+
scale_x_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
scale_y_continuous(expand = c(0,0))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#fed976','#feb24c','#e31a1c','#bd0026','#800026'))+
labs(y=expression('susceptibility reduction by vaccines'~tau))
pl.pandSize.R0
pandSize.R0 <- ldply(invad.list.R0, function(x){
invad.list <- lapply(x, function(df){
a <- ldply(df,rbind)
return(a)
})
trough <- ldply(invad.list,rbind) %>%
filter(time==5)
return(trough)
})
pandSize.R0 <- pandSize.R0 %>%
mutate(immDur=1/H3vac.sigmaV,vac.rate=H3vac.cov/52*100,
pandSize=I1+I21+IV1)
pl.pandSize.R0 <- ggplot(pandSize.R0,aes(x=vac.rate,y=H3vac.tau2,z=pandSize*1000)) +
facet_grid(immDur~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/immDur),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.6, "lines"))+
geom_contour_filled(bins=5)+
labs(fill='Pandemic attack \nrate (x10e-3)',color='')+
xlab('Vaccination rate (%) per week')+
scale_x_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
scale_y_continuous(expand = c(0,0))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#fed976','#feb24c','#e31a1c','#bd0026','#800026'))+
labs(y=expression('susceptibility reduction by vaccines'~tau))
pl.pandSize.R0
pl.pandSize.R0 <- ggplot(pandSize.R0,aes(x=vac.rate,y=H3vac.tau2,z=pandSize*1000)) +
facet_grid(immDur~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/immDur),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.6, "lines"))+
geom_contour_filled(bins=8)+
labs(fill='Pandemic attack \nrate (x10e-3)',color='')+
xlab('Vaccination rate (%) per week')+
scale_x_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
scale_y_continuous(expand = c(0,0))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#fed976','#feb24c','#e31a1c','#bd0026','#800026'))+
labs(y=expression('susceptibility reduction by vaccines'~tau))
pl.pandSize.R0
pl.pandSize.R0 <- ggplot(pandSize.R0,aes(x=vac.rate,y=H3vac.tau2,z=pandSize*1000)) +
facet_grid(immDur~R0_1,scales='free',labeller = label_bquote(rows=sigma[V]:.(1/immDur),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.6, "lines"))+
geom_contour_filled(bins=5)+
labs(fill='Pandemic attack \nrate (x10e-3)',color='')+
xlab('Vaccination rate (%) per week')+
scale_x_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
scale_y_continuous(expand = c(0,0))+
# scale_fill_manual(values=rev(heat.colors(12)))+
scale_fill_manual(values=c('#fed976','#feb24c','#e31a1c','#bd0026','#800026'))+
labs(y=expression('susceptibility reduction by vaccines'~tau))
pl.pandSize.R0
trough.R0 <- ldply(invad.list.R0, function(x){
invad.list <- lapply(x, function(df){
a <- ldply(df,rbind)
return(a)
})
# traj <-ldply(invad.list, function(x){
#   simdf <- ldply(x,rbind)
# })
traj <-ldply(invad.list, rbind)
# traj <- ldply(invad.list,rbind)
trough <- traj %>%
group_by(H3vac.cov,H3vac.tau2,H3vac.sigmaV,R0_1) %>%
summarise(peak.time1=which.max(inci1),trough1=min(inci1),
peak.time2=which.max(inci2),trough2=min(inci2),
Itotal1=sum(inci1),
Itotal2=sum(inci2))
trough[trough$peak.time1==1,'trough1'] <- -1
trough[trough$peak.time2==1,'trough2'] <- -1
# trough$R0 <- x[[2]]
return (trough)
})
troughR0 <- trough.R0 %>%
mutate(immDur=1/H3vac.sigmaV,vac.rate=H3vac.cov/52*100)
troughR0.t1 <- troughR) %>% filter(time==1)
troughR0.t1 <- troughR %>% filter(time==1)
troughR0.t1 <- troughR0 %>% filter(time==1)
View(trough.R0)
load('plot.data.RData')
troughR0 <- trough.R0 %>%
mutate(immDur=1/H3vac.sigmaV,vac.rate=H3vac.cov/52*100)
library(dplyr)
troughR0 <- trough.R0 %>%
mutate(immDur=1/H3vac.sigmaV,vac.rate=H3vac.cov/52*100)
pl.troughR0 <- ggplot(troughR0,aes(x=vac.rate,y=H3vac.tau2,z=trough1)) +
facet_grid(immDur~R0_1,scales='free',
labeller = label_bquote(rows=sigma[V]:.(1/immDur),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.6, "lines"))+
geom_contour_filled(bins=4,breaks=c(-2,0,10e-8,10e-6,10e-4)) +
geom_contour(bins=4,breaks=c(-2,0,10e-8,10e-6,10e-4),
aes(colour = factor(..level..==10e-6,levels = c(T, F),
labels = c("Pandemic persistence","")))) +
scale_colour_manual(values = c("black", "#00000000")) +
labs(fill='Trough depth',color='')+
xlab('Vaccination rate (%) per week')+
scale_x_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values=c('grey','#FFF4BD',
'#feb24c','#bd0026'),
labels=list("<0",expression(0-10^{-8}),
expression(10^{-8}-10^{-6}),
expression(10^{-6}-10^{-4})))+
labs(y=expression('susceptibility reduction by vaccines'~tau))
pl.troughR0
library(ggplot2)
pl.troughR0 <- ggplot(troughR0,aes(x=vac.rate,y=H3vac.tau2,z=trough1)) +
facet_grid(immDur~R0_1,scales='free',
labeller = label_bquote(rows=sigma[V]:.(1/immDur),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.6, "lines"))+
geom_contour_filled(bins=4,breaks=c(-2,0,10e-8,10e-6,10e-4)) +
geom_contour(bins=4,breaks=c(-2,0,10e-8,10e-6,10e-4),
aes(colour = factor(..level..==10e-6,levels = c(T, F),
labels = c("Pandemic persistence","")))) +
scale_colour_manual(values = c("black", "#00000000")) +
labs(fill='Trough depth',color='')+
xlab('Vaccination rate (%) per week')+
scale_x_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values=c('grey','#FFF4BD',
'#feb24c','#bd0026'),
labels=list("<0",expression(0-10^{-8}),
expression(10^{-8}-10^{-6}),
expression(10^{-6}-10^{-4})))+
labs(y=expression('susceptibility reduction by vaccines'~tau))
pl.troughR0
pl.troughR0
pl.troughR0 <- ggplot(troughR0,aes(x=vac.rate,y=H3vac.tau2,z=trough1)) +
facet_grid(immDur~R0_1,scales='free',
labeller = label_bquote(rows=sigma[V]:.(1/immDur),
cols=R[0]^1:.(R0_1)))+
theme_classic()+
theme(panel.spacing = unit(0.6, "lines"))+
geom_contour_filled(bins=4,breaks=c(-2,0,10e-8,10e-6,10e-4)) +
geom_contour(bins=4,breaks=c(-2,0,10e-8,10e-6,10e-4),
aes(colour = factor(..level..==10e-6,levels = c(T, F),
labels = c("Pandemic persistence","")))) +
scale_colour_manual(values = c("black", "#00000000")) +
labs(fill='Trough depth',color='')+
xlab('Vaccination rate (%) per week')+
scale_x_continuous(expand = c(0,0),labels=c('0','0.25','0.5','0.75','1'))+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values=c('grey','#FFF4BD',
'#feb24c','#bd0026'),
labels=list("No invasion",expression(0-10^{-8}),
expression(10^{-8}-10^{-6}),
expression(10^{-6}-10^{-4})))+
labs(y=expression('susceptibility reduction by vaccines'~tau))
pl.troughR0
ggsave('invasion/H3endemicVac.pandStrR0varyRhoInvad.NoNatImm.trough.png',pl.troughR0, width=7,height=6)
